<!doctype html>
<html lang="ar">
<head>
<meta charset="utf-8" />
<title>Anah Digital Twin â€“ Stable</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link rel="stylesheet"
  href="https://cesium.com/downloads/cesiumjs/releases/1.118/Build/Cesium/Widgets/widgets.css" />
<script src="https://cesium.com/downloads/cesiumjs/releases/1.118/Build/Cesium/Cesium.js"></script>

<style>
html, body, #cesiumContainer {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  font-family: system-ui, Arial;
}

/* Ø§Ù„Ø¹Ù†ÙˆØ§Ù† */
.topbar {
  position: absolute;
  top: 10px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,.6);
  color: #fff;
  padding: 8px 16px;
  border-radius: 10px;
  z-index: 10;
}

/* Ù„ÙˆØ­Ø© Ø§Ù„Ø·Ø¨Ù‚Ø§Øª */
.layers-panel {
  position: absolute;
  top: 70px;
  left: 10px;
  width: 260px;
  background: rgba(255,255,255,.95);
  border-radius: 12px;
  box-shadow: 0 10px 30px rgba(0,0,0,.25);
  padding: 12px;
  z-index: 10;
  max-height: 75%;
  overflow-y: auto;
}

.layers-panel h3 {
  margin: 0 0 8px;
  font-size: 15px;
  text-align: center;
}

.layer-item {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 6px;
  font-size: 14px;
}

.layer-color {
  width: 14px;
  height: 14px;
  border-radius: 4px;
}
</style>
</head>

<body>

<div class="topbar">
ğŸ™ï¸ Ø§Ù„ØªÙˆØ£Ù… Ø§Ù„Ø±Ù‚Ù…ÙŠ Ù„Ù…Ø¯ÙŠÙ†Ø© Ø¹Ù†Ù‡ â€“ Anah Digital Twin
</div>

<div class="layers-panel" id="layersPanel">
  <h3>Ø·Ø¨Ù‚Ø§Øª Ø§Ù„Ø§Ø³ØªØ¹Ù…Ø§Ù„Ø§Øª</h3>
</div>

<div id="cesiumContainer"></div>

<script>
// ================= TOKEN =================
Cesium.Ion.defaultAccessToken =
"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIyNWMxYmU5Ni0zZWUwLTRkNDctYjdhMC01NWY1M2RiN2U4NTUiLCJpZCI6MzU3NDMyLCJpYXQiOjE3Njc3MTUyNzB9.HBEzgBC5NskreMa2Fr6mb7cZNW74AX6XkYu-IKDw8WQ";

// ================= VIEWER =================
const viewer = new Cesium.Viewer("cesiumContainer", {
  terrainProvider: false,      // âŒ Ù„Ø§ Terrain
  timeline: false,
  animation: false,
  sceneModePicker: false,
  navigationHelpButton: false,
  baseLayerPicker: false,
  geocoder: true,
  homeButton: true,
  fullscreenButton: true,
  shadows: false               // âŒ Ù„Ø§ Ø¸Ù„Ø§Ù„
});

// ================= ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù…Ø´Ù‡Ø¯ =================

// âŒ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ÙƒØ±Ø© Ø§Ù„Ø£Ø±Ø¶ÙŠØ© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹
viewer.scene.globe.show = false;

// âŒ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØµÙˆØ± Ø§Ù„ÙØ¶Ø§Ø¦ÙŠØ©
viewer.imageryLayers.removeAll();

// ğŸ¨ Ø¥Ø¹Ø¯Ø§Ø¯ Ø¨ØµØ±ÙŠ ØªØ®Ø·ÙŠØ·ÙŠ (Ù…Ø«Ù„ CityEngine)
viewer.scene.highDynamicRange = false;
viewer.scene.toneMapping = Cesium.ToneMapping.NONE;
viewer.scene.gamma = 1.0;

viewer.scene.colorCorrection.show = true;
viewer.scene.colorCorrection.brightness = 1.05;
viewer.scene.colorCorrection.contrast = 1.1;
viewer.scene.colorCorrection.saturation = 1.25;

// Ù…Ù†Ø¹ Ø£ÙŠ Ø­Ø³Ø§Ø¨Ø§Øª Ø´Ù…Ø³ÙŠØ©
viewer.scene.globe.enableLighting = false;
viewer.clock.shouldAnimate = false;

// ================= Ø§Ù„Ø·Ø¨Ù‚Ø§Øª =================
const layers = [
  { name: "Residential",  color: "#FFF59D", assetId: 4355603 },
  { name: "Commercial",   color: "#E53935", assetId: 4355604 },
  { name: "Educational",  color: "#1E88E5", assetId: 4355606 },
  { name: "Health",       color: "#EC407A", assetId: 4355607 },
  { name: "Industrial",   color: "#8E24AA", assetId: 4355612 },
  { name: "Religious",    color: "#6D4C41", assetId: 4355610 },
  { name: "Services",     color: "#26C6DA", assetId: 4355609 },
  { name: "Tourist",      color: "#8D6E63", assetId: 4355611 },
  { name: "GreenArea",    color: "#2E7D32", assetId: 4355613 },
  { name: "Public Buildings", color: "#455A64", assetId: 4355599 },
  { name: "3D Houses",    color: "#90CAF9", assetId: 4355597 },
  { name: "Vertical Buildings", color: "#B0BEC5", assetId: 4355602 },
  { name: "Roads",        color: "#9E9E9E", assetId: 4355615 }
];

const panel = document.getElementById("layersPanel");

// ================= ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª =================
(async () => {
  let firstTileset = null;

  for (const layer of layers) {

    const tileset = await Cesium.Cesium3DTileset.fromIonAssetId(layer.assetId);
    viewer.scene.primitives.add(tileset);
    tileset.show = true;

    // ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØªØ­ÙƒÙ…
    const item = document.createElement("div");
    item.className = "layer-item";
    item.innerHTML = `
      <input type="checkbox" checked />
      <div class="layer-color" style="background:${layer.color}"></div>
      <span>${layer.name}</span>
    `;

    item.querySelector("input").addEventListener("change", e => {
      tileset.show = e.target.checked;
    });

    panel.appendChild(item);

    // ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©
    if (!firstTileset) {
      firstTileset = tileset;
      await tileset.readyPromise;
      viewer.camera.flyToBoundingSphere(
        tileset.boundingSphere,
        { duration: 2.5 }
      );
    }
  }
})();
</script>

</body>
</html>
